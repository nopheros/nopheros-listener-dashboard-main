<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Nopheros - Live Listener Dashboard</title>
    <meta name="description" content="Real-time listener statistics for Nopheros radio towers">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
</head>
<body>
    <!-- ========== HEADER ========== -->
    <header class="site-header">
        <div class="header-container">
            <a href="index.html" class="logo-link">
                <img src="img/logo.jpg" alt="Nopheros" class="header-logo">
                <span class="site-title">Nopheros</span>
            </a>
            <nav class="main-nav">
                <a href="index.html" class="nav-link active">Live Dashboard</a>
                <a href="annals.html" class="nav-link">Annals of the Signal</a>
            </nav>
            <div class="header-badges">
                <span class="badge badge-live">
                    <span class="live-dot"></span> Live
                </span>
                <span class="badge" id="last-updated">--</span>
            </div>
        </div>
    </header>

    <main class="main-content">
        <!-- ========== TOWER CARDS ========== -->
        <section class="tower-cards-section">
            <div class="section-header">
                <h2>Tower Status</h2>
                <div class="total-listeners-badge">
                    <span class="label">Total Overall Listeners:</span>
                    <span class="value" id="total-listeners">--</span>
                </div>
            </div>

            <div class="tower-cards-grid">
                <!-- Tower 1 Card -->
                <div class="tower-card" data-tower="tower1">
                    <div class="tower-card-header">
                        <div class="tower-indicator" style="background-color: #3498db;"></div>
                        <h3>Tower 1</h3>
                        <span class="tower-subtitle">Primary Broadcast Tower</span>
                    </div>
                    <div class="tower-stats">
                        <div class="stat">
                            <span class="stat-label">Current Listeners</span>
                            <span class="stat-value" id="tower1-listeners">--</span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Peak Listeners</span>
                            <span class="stat-value" id="tower1-peak">--</span>
                        </div>
                    </div>
                    <div class="tower-now-playing">
                        <span class="np-label">Now Playing:</span>
                        <span class="np-value" id="tower1-np">--</span>
                    </div>
                    <a href="#" class="tower-play-link" id="tower1-play-link" target="_blank" rel="noopener noreferrer">
                        <span class="play-icon">â–¶</span>
                        <span>Listen to Tower 1</span>
                    </a>
                </div>

                <!-- Tower 2 Card -->
                <div class="tower-card" data-tower="tower2">
                    <div class="tower-card-header">
                        <div class="tower-indicator" style="background-color: #9b59b6;"></div>
                        <h3>Tower 2</h3>
                        <span class="tower-subtitle">Secondary Relay Tower</span>
                    </div>
                    <div class="tower-stats">
                        <div class="stat">
                            <span class="stat-label">Current Listeners</span>
                            <span class="stat-value" id="tower2-listeners">--</span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Peak Listeners</span>
                            <span class="stat-value" id="tower2-peak">--</span>
                        </div>
                    </div>
                    <div class="tower-now-playing">
                        <span class="np-label">Now Playing:</span>
                        <span class="np-value" id="tower2-np">--</span>
                    </div>
                    <a href="#" class="tower-play-link" id="tower2-play-link" target="_blank" rel="noopener noreferrer">
                        <span class="play-icon">â–¶</span>
                        <span>Listen to Tower 2</span>
                    </a>
                </div>

                <!-- Tower 3 Card (INFO ONLY) -->
                <div class="tower-card tower-card-info-only" data-tower="tower3">
                    <div class="tower-card-header">
                        <div class="tower-indicator" style="background-color: #27ae60;"></div>
                        <h3>Tower 3</h3>
                        <span class="tower-subtitle">Atlantean Testing Relay</span>
                        <span class="info-badge">Info Only</span>
                    </div>
                    <div class="tower-flavor">
                        <p>That rickety old tower those skeezy Gnomes wouldn't even touch...</p>
                    </div>
                    <div class="tower-now-playing">
                        <span class="np-label">Now Playing:</span>
                        <span class="np-value" id="tower3-np">--</span>
                    </div>
                    <a href="#" class="tower3-play-link" id="tower3-play-link" target="_blank" rel="noopener noreferrer">
                        <span class="play-icon">â–¶</span>
                        <span>Listen to Tower 3</span>
                    </a>
                </div>
            </div>
        </section>

        <!-- ========== LIVE CHART ========== -->
        <section class="chart-section">
            <div class="chart-panel">
                <div class="panel-header">
                    <h2>Listener Activity</h2>
                    <div class="chart-controls">
                        <button class="range-btn active" data-range="24h">Last 24h</button>
                        <button class="range-btn" data-range="all">All Time</button>
                        <button class="btn-icon" id="refresh-chart" title="Refresh now">
                            ðŸ”„
                        </button>
                    </div>
                </div>
                <p class="chart-note">Tower 1 + Tower 2 only. Total listeners shown as bold line. Click legend to toggle.</p>
                <div class="chart-wrapper">
                    <canvas id="listeners-chart"></canvas>
                </div>
                <div class="chart-footer">
                    <button class="btn-secondary" id="export-csv">Export CSV</button>
                    <button class="btn-secondary" id="download-json">Download JSON</button>
                </div>
            </div>
        </section>

        <!-- ========== WEEKLY SCHEDULE ========== -->
        <section class="schedule-section">
            <div class="schedule-panel">
                <div class="panel-header">
                    <h2>Weekly Schedule</h2>
                </div>
                <p class="schedule-note">All times shown in EST and UK London</p>
                <div class="schedule-table-wrapper">
                    <table class="schedule-table">
                        <thead>
                            <tr>
                                <th>Day</th>
                                <th>Show</th>
                                <th>DJ</th>
                                <th>EST</th>
                                <th>UK</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Monday</td>
                                <td>Treehab with DJ Nopheros</td>
                                <td>Nopheros</td>
                                <td>11:00 AM</td>
                                <td>16:00</td>
                            </tr>
                            <tr>
                                <td>Monday</td>
                                <td>Living in the Past</td>
                                <td>Leto</td>
                                <td>6:00 PM</td>
                                <td>23:00</td>
                            </tr>
                            <tr>
                                <td>Tuesday</td>
                                <td>Groovin' in the Graveyard</td>
                                <td>Crustman</td>
                                <td>3:00 PM</td>
                                <td>20:00</td>
                            </tr>
                            <tr>
                                <td>Tuesday</td>
                                <td>The Whiski Lounge</td>
                                <td>Whiski</td>
                                <td>9:00 PM</td>
                                <td>3:00</td>
                            </tr>
                            <tr>
                                <td>Wednesday</td>
                                <td>The Deeprun Classix & Mashups with Kando</td>
                                <td>Kando</td>
                                <td>04:00 PM</td>
                                <td>22:00</td>
                            </tr>
                            <tr>
                                <td>Friday</td>
                                <td>Pilgrim of the Signal</td>
                                <td>Nopheros</td>
                                <td>06:00 PM</td>
                                <td>23:00</td>
                            </tr>
                            <tr>
                                <td>Saturday</td>
                                <td>Tavern Talks with Sheal</td>
                                <td>Sheal</td>
                                <td>3:00 PM</td>
                                <td>20:00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- ========== PI HEALTH (OPTIONAL) ========== -->
        <section class="pi-health-section">
            <div class="health-toggle">
                <span class="badge health-badge">
                    Pi Health
                    <span class="health-indicator" id="pi-status-indicator"></span>
                </span>
                <div class="health-panel" id="pi-health-panel">
                    <div class="health-title">Raspberry Pi Status</div>
                    <div class="health-row">
                        <span>Temperature</span>
                        <span id="pi-temp">--</span>
                    </div>
                    <div class="health-row">
                        <span>Disk</span>
                        <span id="pi-disk">--</span>
                    </div>
                    <div class="health-row">
                        <span>Memory</span>
                        <span id="pi-mem">--</span>
                    </div>
                    <div class="health-row">
                        <span>Load (1/5/15)</span>
                        <span id="pi-load">--</span>
                    </div>
                    <div class="health-row">
                        <span>Updated</span>
                        <span id="pi-health-updated">--</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== EMBEDDED PLAYER (BOTTOM) ========== -->
        <section class="player-section">
            <div class="player-card primary-player">
                <div class="player-header">
                    <h2>Tower 1 - Primary Broadcast</h2>
                    <button class="reload-btn" id="player-reload" title="Re-sync to live stream">
                        <span class="reload-icon">ðŸ”„</span>
                        <span class="reload-text">Re-sync</span>
                    </button>
                </div>
                <div class="player-controls">
                    <audio id="tower1-player" controls preload="none">
                        <source src="" type="audio/mpeg" id="tower1-source">
                        Your browser does not support the audio element.
                    </audio>
                </div>
                <p class="now-playing" id="tower1-now-playing">Loading track...</p>
            </div>
        </section>
    </main>

    <!-- ========== FOOTER ========== -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-brand">
                <img src="img/logo.jpg" alt="Nopheros" class="footer-logo">
                <span>Nopheros Radio Network</span>
            </div>
            <nav class="footer-nav">
                <a href="index.html">Live Dashboard</a>
                <a href="annals.html">Annals of the Signal</a>
            </nav>
            <div class="footer-info">
                <p>Data refreshes every 60 seconds</p>
                <p class="footer-credit">Powered by Icecast</p>
            </div>
        </div>
    </footer>

    <!-- ========== SCRIPTS ========== -->
    <script src="js/config.js"></script>
    <script src="js/icecast.js"></script>
    <script src="js/live-dashboard.js"></script>
</body>
</html>
