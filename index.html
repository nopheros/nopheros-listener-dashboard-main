<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ELBC Statmographifier - Live Listener Dashboard</title>
    <meta name="description" content="Real-time listener statistics for the Everlook Broadcasting Co. towers">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
</head>
<body>
    <!-- ========== HEADER ========== -->
    <header class="site-header">
        <div class="header-container">
            <a href="index.html" class="logo-link">
                <img src="img/elbc_logo.png" alt="ELBC Everlook Logo" class="header-logo">
                <div class="logo-text">
                    <span class="site-title">Dwarvish &amp; Gnomish Engineered Everlook Broadcasting Co. Statmographifier</span>
                    <a href="https://nopheros.com" class="by-nopheros" target="_blank" rel="noopener noreferrer">By Nopheros</a>
                </div>
            </a>
            <nav class="main-nav">
                <a href="index.html" class="nav-link active">Live Dashboard</a>
                <a href="annals.html" class="nav-link">Annals of the Signal</a>
            </nav>
            <div class="header-badges">
                <button id="theme-toggle" class="theme-toggle-btn" title="Toggle light/dark mode">
                    <span class="theme-icon">‚òÄÔ∏è</span>
                </button>
                <span class="badge badge-live">
                    <span class="live-dot"></span> Live
                </span>
                <span class="badge" id="last-updated">--</span>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="content-wrapper-single">
            <!-- ========== TWO COLUMN LAYOUT ========== -->
            <div class="dashboard-grid">
                <!-- LEFT COLUMN: Upcoming Shows + Weekly Schedule -->
                <div class="left-column">
                    <!-- UPCOMING SHOWS (Tower 1 Only) -->
                    <section class="upcoming-shows-section">
                        <div class="panel-header">
                            <h2>Upcoming Shows</h2>
                        </div>
                        <div class="events-list" id="events-list">
                            <p class="events-loading">Loading schedule...</p>
                        </div>
                    </section>

                    <!-- WEEKLY SCHEDULE (Tightened) -->
                    <section class="schedule-section-compact">
                        <div class="panel-header">
                            <h2>Weekly Schedule</h2>
                        </div>
                        <table class="schedule-table">
                            <thead>
                                <tr>
                                    <th>Day</th>
                                    <th>Show</th>
                                    <th>DJ</th>
                                    <th>EST</th>
                                    <th>ST</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Monday</td>
                                    <td>Treehab</td>
                                    <td><a href="https://twitch.tv/Nopheros" target="_blank" class="dj-link">Nopheros</a></td>
                                    <td>11 AM</td>
                                    <td>4 PM</td>
                                </tr>
                                <tr>
                                    <td>Monday</td>
                                    <td>Living in the Past</td>
                                    <td>Leto</td>
                                    <td>6 PM</td>
                                    <td>11 PM</td>
                                </tr>
                                <tr>
                                    <td>Tuesday</td>
                                    <td>Groovin' Graveyard</td>
                                    <td>Crustman</td>
                                    <td>3 PM</td>
                                    <td>8 PM</td>
                                </tr>
                                <tr>
                                    <td>Tuesday</td>
                                    <td>The Whiski Lounge</td>
                                    <td><a href="https://twitch.tv/DJWhiski" target="_blank" class="dj-link">Whiski</a></td>
                                    <td>9 PM</td>
                                    <td>2 AM</td>
                                </tr>
                                <tr>
                                    <td>Wednesday</td>
                                    <td>Deeprun Classix</td>
                                    <td>Kando</td>
                                    <td>4 PM</td>
                                    <td>9 PM</td>
                                </tr>
                                <tr>
                                    <td>Friday</td>
                                    <td>Pilgrim of Signal</td>
                                    <td><a href="https://twitch.tv/Nopheros" target="_blank" class="dj-link">Nopheros</a></td>
                                    <td>12 PM</td>
                                    <td>5 PM</td>
                                </tr>
                                <tr>
                                    <td>Saturday</td>
                                    <td>Tavern Talks</td>
                                    <td><a href="https://twitch.tv/DJ_Sheal" target="_blank" class="dj-link">Sheal</a></td>
                                    <td>3 PM</td>
                                    <td>8 PM</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                </div>

                <!-- RIGHT COLUMN: Tower 1 Media Player -->
                <div class="right-column">
                    <section class="tower1-player-section">
                        <div class="panel-header">
                            <h2>Everlook Broadcasting Co.</h2>
                        </div>
                        <div class="player-content">
                            <img src="img/elbc_logo.png" alt="ELBC Logo" class="elbc-logo-large">
                            <p class="tune-in-label">Tune in:</p>
                            <button class="play-btn-gold" id="tower1-play-btn" title="Play Tower 1">
                                <span class="play-icon">‚ñ∂</span>
                            </button>
                            <p class="now-playing-text" id="player-now-playing">Loading...</p>
                            <div class="player-stats-inline">
                                <span id="player-listeners">--</span> listeners | Peak: <span id="player-peak">--</span>
                            </div>
                            <audio id="tower1-player" preload="none" style="display:none;">
                                <source src="" type="audio/mpeg" id="tower1-source">
                            </audio>
                        </div>
                    </section>
                </div>
            </div>

            <!-- ========== TALE OF THREE TOWERS ========== -->
            <section class="tower-cards-section">
                <div class="section-header">
                    <h2>Tale of Three Towers</h2>
                    <div class="total-listeners-badge">
                        <span class="label">Total Overall Listeners:</span>
                        <span class="value" id="total-listeners">--</span>
                    </div>
                </div>

                <div class="tower-cards-grid">
                    <!-- Tower 1 Card -->
                    <div class="tower-card" data-tower="tower1">
                        <div class="tower-card-header">
                            <div class="tower-indicator" style="background-color: #3498db;"></div>
                            <h3>Tower 1 Info</h3>
                            <span class="tower-subtitle">NX78</span>
                        </div>
                        <div class="tower-stats">
                            <div class="stat">
                                <span class="stat-label">Current Listeners</span>
                                <span class="stat-value" id="tower1-listeners">--</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Peak Listeners</span>
                                <span class="stat-value" id="tower1-peak">--</span>
                            </div>
                        </div>
                        <div class="tower-now-playing">
                            <span class="np-label">Now Playing:</span>
                            <span class="np-value" id="tower1-np">--</span>
                        </div>
                    </div>

                    <!-- Tower 2 Card -->
                    <div class="tower-card" data-tower="tower2">
                        <div class="tower-card-header">
                            <div class="tower-indicator" style="background-color: #9b59b6;"></div>
                            <h3>Tower 2</h3>
                            <span class="tower-subtitle">LG87</span>
                        </div>
                        <div class="tower-stats">
                            <div class="stat">
                                <span class="stat-label">Current Listeners</span>
                                <span class="stat-value" id="tower2-listeners">--</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Peak Listeners</span>
                                <span class="stat-value" id="tower2-peak">--</span>
                            </div>
                        </div>
                        <div class="tower-now-playing">
                            <span class="np-label">Now Playing:</span>
                            <span class="np-value" id="tower2-np">--</span>
                        </div>
                    </div>

                    <!-- Tower 3 Card with Purple Glowing Cursed Play Button -->
                    <div class="tower-card tower-card-cursed" data-tower="tower3">
                        <div class="tower-card-header">
                            <div class="tower-indicator" style="background-color: #9b59b6;"></div>
                            <h3>Tower 3</h3>
                            <span class="tower-subtitle">Atlantean Testing Relay</span>
                        </div>
                        <div class="tower-stats">
                            <div class="stat">
                                <span class="stat-label">Current Listeners</span>
                                <span class="stat-value" id="tower3-listeners">--</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Peak Listeners</span>
                                <span class="stat-value" id="tower3-peak">--</span>
                            </div>
                        </div>
                        <div class="tower-now-playing">
                            <span class="np-label">Now Playing:</span>
                            <span class="np-value" id="tower3-np">--</span>
                        </div>
                        <button class="cursed-play-btn" id="tower3-play-btn" title="Play Cursed Tower 3">
                            <span class="play-icon">‚ñ∂</span>
                            <span class="cursed-text">Listen Now</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- ========== LISTENER GRAPH ========== -->
            <section class="chart-section">
                <div class="chart-panel">
                    <div class="panel-header">
                        <h2>Listener Graph</h2>
                        <div class="chart-controls">
                            <button class="range-btn" data-range="2h">2 Hours</button>
                            <button class="range-btn active" data-range="24h">24 Hours</button>
                            <button class="range-btn" data-range="3d">3 Days</button>
                            <button class="range-btn" data-range="week">Week</button>
                            <button class="btn-icon" id="refresh-chart" title="Refresh now">üîÑ</button>
                        </div>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="listeners-chart"></canvas>
                    </div>
                    <div class="chart-footer">
                        <button class="btn-secondary" id="export-csv">Export CSV</button>
                        <button class="btn-secondary" id="download-json">Download JSON</button>
                        <p class="chart-refresh-info">Live updates every 60 seconds</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- ========== FOOTER ========== -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-brand">
                <img src="img/elbc_logo.png" alt="ELBC Everlook Logo" class="footer-logo">
                <span>Everlook Broadcasting Co. Statmographifier</span>
            </div>
            <nav class="footer-nav">
                <a href="index.html">Live Dashboard</a>
                <a href="annals.html">Annals of the Signal</a>
            </nav>
            <div class="footer-info">
                <p class="footer-credit">Powered by Icecast</p>
            </div>
        </div>
    </footer>

    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/icecast.js"></script>
    <script type="module" src="js/live-dashboard.js"></script>
</body>
</html>
